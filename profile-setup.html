<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로필 설정 - 스프링...</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* 프로필 설정 페이지 스타일 */
        .profile-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 10px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .profile-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group label {
            font-weight: bold;
            font-size: 14px;
        }
        
        .form-group input, 
        .form-group select, 
        .form-group textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .profile-image-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .profile-image-preview {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .profile-image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .submit-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        .submit-btn:hover {
            background-color: #2980b9;
        }
        
        .skip-btn {
            text-align: center;
            margin-top: 20px;
        }
        
        .skip-btn a {
            color: #777;
            text-decoration: none;
            font-size: 14px;
        }
        
        .skip-btn a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="profile-container">
        <div class="profile-header">
            <h1>프로필 설정</h1>
            <p>인연 매칭을 위한 정보를 설정해주세요</p>
        </div>
        
        <form id="profileForm" class="profile-form">
            <div class="profile-image-container">
                <div class="profile-image-preview" id="profileImagePreview">
                    <!-- 기본 프로필 이미지 또는 사용자 프로필 이미지가 표시됩니다 -->
                    <img id="previewImg" src="" alt="프로필 이미지">
                </div>
                <input type="file" id="profileImageInput" accept="image/*" style="display: none;">
                <button type="button" id="changeProfileImageBtn" class="btn btn-outline">프로필 이미지 변경</button>
            </div>
            
            <div class="form-group">
                <label for="nickname">닉네임 (필수)</label>
                <input type="text" id="nickname" name="nickname" required>
            </div>
            
            <div class="form-group">
                <label for="gender">성별</label>
                <select id="gender" name="gender">
                    <option value="">선택하지 않음</option>
                    <option value="male">남성</option>
                    <option value="female">여성</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="ageRange">연령대</label>
                <select id="ageRange" name="ageRange">
                    <option value="">선택하지 않음</option>
                    <option value="10s">10대</option>
                    <option value="20s">20대</option>
                    <option value="30s">30대</option>
                    <option value="40s">40대</option>
                    <option value="50s">50대 이상</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="bio">자기소개</label>
                <textarea id="bio" name="bio" placeholder="자신에 대해 간단히 소개해주세요"></textarea>
            </div>
            
            <button type="submit" class="submit-btn">프로필 저장하기</button>
        </form>
        
        <div class="skip-btn">
            <a href="index.html" id="skipProfileSetup">나중에 설정하기</a>
        </div>
    </div>
    
    <script src="profile-setup.js"></script>
    <script>
        // 임시로 프로필 설정 페이지에서 필요한 기본 기능만 구현
        document.addEventListener('DOMContentLoaded', function() {
            // 로컬 스토리지에서 사용자 정보 가져오기
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                // 로그인 정보가 없으면 로그인 페이지로 리다이렉션
                window.location.href = 'index.html';
                return;
            }
            
            const userInfo = JSON.parse(currentUser);
            
            // 프로필 이미지가 있으면 표시
            const previewImg = document.getElementById('previewImg');
            if (userInfo.profileImage) {
                previewImg.src = userInfo.profileImage;
            } else {
                previewImg.src = 'default-profile.png'; // 기본 이미지 경로 설정
            }
            
            // 닉네임 초기값 설정
            const nicknameInput = document.getElementById('nickname');
            if (userInfo.nickname) {
                nicknameInput.value = userInfo.nickname;
            }
            
            // 프로필 이미지 변경 버튼 클릭 이벤트
            const changeProfileImageBtn = document.getElementById('changeProfileImageBtn');
            const profileImageInput = document.getElementById('profileImageInput');
            
            changeProfileImageBtn.addEventListener('click', function() {
                profileImageInput.click();
            });
            
            // 파일 선택 시 이미지 미리보기
            profileImageInput.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImg.src = e.target.result;
                    }
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
            
            // 프로필 저장 이벤트
            const profileForm = document.getElementById('profileForm');
            profileForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 프로필 정보 저장
                const updatedUserInfo = {
                    ...userInfo,
                    nickname: nicknameInput.value,
                    gender: document.getElementById('gender').value,
                    ageRange: document.getElementById('ageRange').value,
                    bio: document.getElementById('bio').value,
                    profileCompleted: true // 프로필 설정 완료 표시
                };
                
                // 이미지는 Firebase Storage에 업로드해야 하지만
                // 현재는 간단히 로컬 스토리지에만 저장
                // 실제 구현 시 Firebase Storage 연동 필요
                
                // 로컬 스토리지에 업데이트된 정보 저장
                localStorage.setItem('currentUser', JSON.stringify(updatedUserInfo));
                
                alert('프로필이 저장되었습니다.');
                
                // 메인 페이지로 이동
                window.location.href = 'index.html';
            });
            
            // 나중에 설정하기 버튼
            const skipProfileSetup = document.getElementById('skipProfileSetup');
            skipProfileSetup.addEventListener('click', function(e) {
                e.preventDefault();
                
                // 사용자 정보 업데이트 - 나중에 다시 프로필 설정 화면을 표시하기 위해 profileCompleted를 true로 설정하지 않음
                const updatedUserInfo = {
                    ...userInfo,
                    profilePrompted: true // 프로필 설정을 권유했음을 표시
                };
                
                localStorage.setItem('currentUser', JSON.stringify(updatedUserInfo));
                
                // 메인 페이지로 이동
                window.location.href = 'index.html';
            });
        });
    </script>
</body>
</html>
